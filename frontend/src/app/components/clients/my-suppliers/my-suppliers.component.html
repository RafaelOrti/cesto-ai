<div class="my-suppliers-container">
  <!-- Header -->
  <div class="page-header">
    <div class="header-content">
      <h1>{{ i18n.translate('suppliers.mySuppliers') }}</h1>
      <p>{{ i18n.translate('suppliers.manageRelationships') }}</p>
    </div>
    <div class="header-actions">
      <button mat-raised-button color="primary" (click)="loadSuppliers()">
        <i class="fas fa-sync-alt"></i>
        {{ i18n.translate('common.refresh') }}
      </button>
    </div>
  </div>

  <!-- Filters -->
  <div class="filters-section">
    <div class="search-container">
      <mat-form-field appearance="outline" class="search-field">
        <mat-label>{{ i18n.translate('common.search') }}</mat-label>
        <input 
          matInput 
          [(ngModel)]="searchQuery" 
          (input)="onSearch()"
          [placeholder]="i18n.translate('suppliers.searchPlaceholder')">
        <mat-icon matSuffix>search</mat-icon>
      </mat-form-field>
      <!-- Quick filter chips under searchbar to match mock -->
      <mat-chip-set class="quick-filters">
        <mat-chip 
          *ngFor="let filter of quickFilters"
          [selected]="filter.active"
          (click)="toggleQuickFilter(filter)"
          class="filter-chip">
          {{ filter.label }}
        </mat-chip>
      </mat-chip-set>
    </div>

    <div class="filter-controls">
      <mat-form-field appearance="outline" class="filter-field">
        <mat-label>{{ i18n.translate('common.category') }}</mat-label>
        <mat-select [(ngModel)]="selectedCategory" (selectionChange)="onCategoryChange()">
          <mat-option value="all">{{ i18n.translate('common.allCategories') }}</mat-option>
          <mat-option *ngFor="let category of categories" [value]="category">
            {{ category }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field appearance="outline" class="filter-field">
        <mat-label>{{ i18n.translate('common.status') }}</mat-label>
        <mat-select [(ngModel)]="selectedStatus" (selectionChange)="onStatusChange()">
          <mat-option *ngFor="let status of statusOptions" [value]="status.value">
            {{ status.label }}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-container">
    <mat-spinner diameter="50"></mat-spinner>
    <p>{{ i18n.translate('common.loading') }}</p>
  </div>

  <!-- Suppliers Grid -->
  <div *ngIf="!isLoading" class="suppliers-grid">
    <div *ngFor="let supplier of filteredSuppliers" class="supplier-card">
      <!-- Supplier Header -->
      <div class="supplier-header">
        <div class="supplier-logo">
          <img *ngIf="supplier.logo" [src]="supplier.logo" [alt]="supplier.companyName">
          <div *ngIf="!supplier.logo" class="logo-placeholder">
            <i class="fas fa-building"></i>
          </div>
        </div>
        <div class="supplier-info">
          <h3 class="company-name">{{ supplier.companyName }}</h3>
          <div class="supplier-meta">
            <span class="rating">{{ getSupplierRating(supplier) }}</span>
            <span class="verified" *ngIf="supplier.isVerified">
              <i class="fas fa-check-circle"></i>
              {{ i18n.translate('common.verified') }}
            </span>
          </div>
        </div>
        <div class="supplier-status">
          <span class="status-badge" [ngClass]="getStatusClass(supplier.relationshipStatus)">
            {{ getStatusLabel(supplier.relationshipStatus) }}
          </span>
        </div>
      </div>

      <!-- Supplier Description -->
      <div class="supplier-description">
        <p>{{ supplier.description || 'No description available' }}</p>
      </div>

      <!-- Supplier Categories -->
      <div class="supplier-categories">
        <mat-chip-list>
          <mat-chip *ngFor="let category of supplier.categories.slice(0, 3)">
            {{ category }}
          </mat-chip>
          <mat-chip *ngIf="supplier.categories.length > 3" class="more-chip">
            +{{ supplier.categories.length - 3 }} more
          </mat-chip>
        </mat-chip-list>
      </div>

      <!-- Supplier Stats -->
      <div class="supplier-stats">
        <div class="stat-item">
          <span class="stat-label">{{ i18n.translate('common.orders') }}</span>
          <span class="stat-value">{{ supplier.totalOrders }}</span>
        </div>
        <div class="stat-item">
          <span class="stat-label">{{ i18n.translate('common.totalSpent') }}</span>
          <span class="stat-value">{{ formatCurrency(supplier.totalSpent) }}</span>
        </div>
        <div class="stat-item" *ngIf="supplier.lastOrderDate">
          <span class="stat-label">{{ i18n.translate('common.lastOrder') }}</span>
          <span class="stat-value">{{ formatDate(supplier.lastOrderDate) }}</span>
        </div>
      </div>

      <!-- Supplier Terms -->
      <div class="supplier-terms">
        <div class="term-item" *ngIf="supplier.minimumOrderAmount">
          <i class="fas fa-shopping-cart"></i>
          <span>Min Order: {{ formatCurrency(supplier.minimumOrderAmount) }}</span>
        </div>
        <div class="term-item" *ngIf="supplier.deliveryAreas.length > 0">
          <i class="fas fa-truck"></i>
          <span>Delivers to: {{ supplier.deliveryAreas.join(', ') }}</span>
        </div>
        <div class="term-item" *ngIf="supplier.website">
          <i class="fas fa-globe"></i>
          <a [href]="supplier.website" target="_blank">{{ supplier.website }}</a>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="supplier-actions">
        <button 
          mat-button 
          color="primary" 
          (click)="viewSupplierDetails(supplier)">
          <i class="fas fa-eye"></i>
          {{ i18n.translate('common.viewDetails') }}
        </button>
        
        <button 
          *ngIf="canPlaceOrder(supplier)"
          mat-raised-button 
          color="primary" 
          (click)="placeOrder(supplier)">
          <i class="fas fa-shopping-cart"></i>
          {{ i18n.translate('common.placeOrder') }}
        </button>
        
        <button 
          *ngIf="canRequestRelationship(supplier)"
          mat-button 
          color="accent" 
          (click)="requestRelationship(supplier)">
          <i class="fas fa-handshake"></i>
          {{ i18n.translate('common.requestRelationship') }}
        </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="!isLoading && filteredSuppliers.length === 0" class="empty-state">
    <div class="empty-icon">
      <i class="fas fa-handshake"></i>
    </div>
    <h3>{{ i18n.translate('common.noSuppliersFound') }}</h3>
    <p>{{ i18n.translate('common.noSuppliersMatch') }}</p>
    <button mat-raised-button color="primary" (click)="searchQuery = ''; selectedCategory = 'all'; selectedStatus = 'all'; applyFilters()">
      {{ i18n.translate('common.clearFilters') }}
    </button>
  </div>

  <!-- Relationship Request Dialog -->
  <div *ngIf="showRequestForm" class="request-dialog-overlay" (click)="cancelRequest()">
    <div class="request-dialog" (click)="$event.stopPropagation()">
      <div class="dialog-header">
        <h3>{{ i18n.translate('common.requestSupplierRelationship') }}</h3>
        <button mat-icon-button (click)="cancelRequest()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="dialog-content">
        <div class="supplier-info" *ngIf="selectedSupplier">
          <h4>{{ selectedSupplier.companyName }}</h4>
          <p>{{ selectedSupplier.description }}</p>
        </div>
        
        <form [formGroup]="requestForm">
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ i18n.translate('common.requestType') }}</mat-label>
            <mat-select formControlName="requestType">
              <mat-option value="inquiry">{{ i18n.translate('common.generalInquiry') }}</mat-option>
              <mat-option value="order">{{ i18n.translate('common.orderRequest') }}</mat-option>
              <mat-option value="direct">{{ i18n.translate('common.directContact') }}</mat-option>
            </mat-select>
          </mat-form-field>
          
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>{{ i18n.translate('common.message') }}</mat-label>
            <textarea 
              matInput 
              formControlName="message" 
              rows="4"
              placeholder="Tell the supplier about your business and why you'd like to work with them...">
            </textarea>
            <mat-error *ngIf="requestForm.get('message')?.hasError('required')">
              {{ i18n.translate('common.messageRequired') }}
            </mat-error>
            <mat-error *ngIf="requestForm.get('message')?.hasError('minlength')">
              {{ i18n.translate('common.messageMinLength') }}
            </mat-error>
          </mat-form-field>
        </form>
      </div>
      
      <div class="dialog-actions">
        <button mat-button (click)="cancelRequest()">
          {{ i18n.translate('common.cancel') }}
        </button>
        <button 
          mat-raised-button 
          color="primary" 
          (click)="submitRequest()"
          [disabled]="requestForm.invalid">
          {{ i18n.translate('common.sendRequest') }}
        </button>
      </div>
    </div>
  </div>
</div>