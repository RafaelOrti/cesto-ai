<div class="client-insights">
  <div class="insights-header">
    <h1>Client Insights</h1>
    <div class="header-actions">
      <button class="export-btn" (click)="exportData()">
        <i class="icon-export"></i> Export
      </button>
      <button class="settings-btn">
        <i class="icon-settings"></i>
      </button>
    </div>
  </div>

  <div class="controls-bar">
    <div class="filter-section">
      <select [(ngModel)]="selectedFilter" (change)="onFilterChange(selectedFilter)">
        <option *ngFor="let filter of filters" [value]="filter">{{ filter }}</option>
      </select>
      
      <div class="date-range">
        <input type="date" [(ngModel)]="dateRange.from" (change)="onDateRangeChange()">
        <span>-</span>
        <input type="date" [(ngModel)]="dateRange.to" (change)="onDateRangeChange()">
      </div>
      
      <button class="comparison-btn" (click)="addComparison()">Add comparison</button>
      <button class="generate-btn" (click)="generateReport()">Generate</button>
    </div>
  </div>

  <div class="chart-section">
    <div class="chart-container">
      <div class="chart-header">
        <h3>{{ selectedFilter }} Analytics</h3>
        <div class="chart-legend">
          <div class="legend-item" *ngFor="let item of legendData">
            <div class="legend-dot" [style.background-color]="item.color"></div>
            <span>{{ item.value }}</span>
          </div>
        </div>
      </div>
      
      <div class="line-chart">
        <div class="chart-area">
          <div class="y-axis">
            <div class="y-label" *ngFor="let label of ['3.00M', '2.50M', '2.00M', '1.50M', '1.00M', '0.50M', '0.00M']">
              {{ label }}
            </div>
          </div>
          
          <div class="chart-line">
            <svg width="100%" height="100%" viewBox="0 0 800 200">
              <polyline
                [attr.points]="getChartPoints()"
                fill="none"
                stroke="#20B2AA"
                stroke-width="3"
              />
              <circle
                *ngFor="let point of getChartPointsArray()"
                [attr.cx]="point.x"
                [attr.cy]="point.y"
                r="4"
                fill="#20B2AA"
                stroke="white"
                stroke-width="2"
              />
            </svg>
          </div>
          
          <div class="x-axis">
            <div class="x-label" *ngFor="let data of analyticsData.sales">
              {{ data.month }}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="table-section">
    <div class="table-container">
      <table class="performance-table">
        <thead>
          <tr>
            <th>Customer</th>
            <th>Orders ({{ summaryTotals.totalStores }})</th>
            <th>Average order</th>
            <th>Frequency (F)</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let customer of customerData">
            <td class="customer-cell">
              <div class="customer-indicator" [style.background-color]="customer.color"></div>
              {{ customer.name }}
            </td>
            <td>{{ customer.orders | number }}</td>
            <td>{{ customer.averageOrder }}</td>
            <td>{{ customer.frequency }}</td>
          </tr>
        </tbody>
        <tfoot>
          <tr class="summary-row">
            <td><strong>Average of total ({{ summaryTotals.totalStores }})</strong></td>
            <td><strong>{{ summaryTotals.totalOrders | number }}</strong></td>
            <td><strong>{{ summaryTotals.averageOrder }}</strong></td>
            <td><strong>{{ summaryTotals.averageValue }}</strong></td>
          </tr>
        </tfoot>
      </table>
    </div>
  </div>

  <div class="additional-analytics">
    <div class="analytics-grid">
      <div class="analytics-card">
        <h4>Top Performing Clients</h4>
        <div class="performance-list">
          <div class="performance-item" *ngFor="let customer of customerData.slice(0, 3)">
            <span class="customer-name">{{ customer.name }}</span>
            <span class="performance-value">{{ customer.orders | number }}</span>
          </div>
        </div>
      </div>
      
      <div class="analytics-card">
        <h4>Trend Analysis</h4>
        <div class="trend-info">
          <div class="trend-item">
            <span class="trend-label">Growth Rate:</span>
            <span class="trend-value positive">+12.5%</span>
          </div>
          <div class="trend-item">
            <span class="trend-label">Average Order Value:</span>
            <span class="trend-value">${{ summaryTotals.averageValue }}</span>
          </div>
          <div class="trend-item">
            <span class="trend-label">Order Frequency:</span>
            <span class="trend-value">{{ summaryTotals.averageOrder }} orders/month</span>
          </div>
        </div>
      </div>
      
      <div class="analytics-card">
        <h4>Seasonal Patterns</h4>
        <div class="seasonal-info">
          <div class="season-item">
            <span class="season-label">Peak Season:</span>
            <span class="season-value">May-June</span>
          </div>
          <div class="season-item">
            <span class="season-label">Low Season:</span>
            <span class="season-value">Oct-Nov</span>
          </div>
          <div class="season-item">
            <span class="season-label">Growth Trend:</span>
            <span class="season-value positive">Upward</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>